<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Malla Curricular ‚Äì Contadur√≠a P√∫blica</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#eef4fb; --card:#fff; --text:#1f2a44;
  --primary:#2f5fa3; --light:#e9f1fb;
  --approved:#cfe2f9; --locked:#f2f6fb;
}
body.dark{
  --bg:#0e1a2b; --card:#16263d; --text:#e4ecf7;
  --primary:#6ea2e8; --light:#1f3554;
  --approved:#284d7c; --locked:#1a2c47;
}
body{
  margin:0;padding:20px;
  font-family:'Poppins',sans-serif;
  background:var(--bg);color:var(--text);
}
h1{text-align:center;color:var(--primary)}

.top{
  display:flex;flex-wrap:wrap;gap:10px;
  justify-content:space-between;margin-bottom:15px;
}
button,select{
  padding:6px 10px;border-radius:8px;border:none;
}
button{background:var(--primary);color:#fff;cursor:pointer}

.progress-bar{
  height:12px;background:#cbd9ee;
  border-radius:10px;overflow:hidden
}
.progress-fill{
  height:100%;width:0;
  background:var(--primary);transition:.4s
}

.grid{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:16px;
}
.column{
  background:var(--card);
  border-radius:16px;
  padding:12px;
}
.column h3{text-align:center;color:var(--primary)}
.level-info{
  text-align:center;
  font-size:.75em;
  margin-bottom:10px;
  line-height:1.4;
}
.course{
  background:var(--light);
  padding:8px;
  border-radius:10px;
  margin-bottom:8px;
  cursor:pointer;
  font-size:.85em;
}
.course:hover{transform:scale(1.03)}
.approved{background:var(--approved);text-decoration:line-through}
.plan{outline:2px dashed var(--primary)}
</style>
</head>

<body>

<h1>Malla Curricular ‚Äì Contadur√≠a P√∫blica</h1>

<div class="top">
  <div style="flex:1">
    <div id="creditText"></div>
    <div class="progress-bar">
      <div id="progressFill" class="progress-fill"></div>
    </div>
  </div>
  <div>
    <select id="planSelect"></select>
    <button onclick="newPlan()">‚ûï Plan</button>
    <button onclick="deletePlan()">üóëÔ∏è</button>
    <button onclick="togglePlan()">üìã Planear</button>
    <button onclick="toggleDark()">üåô</button>
  </div>
</div>

<div id="planCredits"></div>
<div id="grid" class="grid"></div>

<script>
/* ===================== ESTADO ===================== */
const approved = new Set(JSON.parse(localStorage.getItem('approvedCourses')||'[]'));
let plans = JSON.parse(localStorage.getItem('plans')||'{}');
let currentPlan = null;
let planning = false;

/* ===================== DATA COMPLETA ===================== */
const data = [
{level:'Nivel 1',courses:[
{id:'1502010',name:'Cultura Contable',credits:3,req:[]},
{id:'1502014',name:'Semillero de Investigaci√≥n I',credits:1,req:[]},
{id:'1502015',name:'Fundamentos Interdisciplinarios',credits:4,req:[]},
{id:'1502016',name:'Interdisciplinariedad',credits:4,req:[]},
{id:'1502150',name:'Ingl√©s I',credits:1,req:[]},
{id:'1504101',name:'Matem√°ticas I',credits:4,req:[]}
]},
{level:'Nivel 2',courses:[
{id:'1502021',name:'Estructura Contable',credits:3,req:['1502015']},
{id:'1502024',name:'Metodolog√≠a de la Investigaci√≥n',credits:5,req:[]},
{id:'1502026',name:'Semillero II',credits:1,req:['1502014']},
{id:'1502151',name:'Ingl√©s II',credits:1,req:['1502150']},
{id:'1504102',name:'Matem√°ticas II',credits:3,req:['1504101']},
{id:'1506016',name:'Taller de Lectura y Escritura',credits:3,req:[]}
]},
{level:'Nivel 3',courses:[
{id:'1502031',name:'Procesos Contables I',credits:4,req:['1502021']},
{id:'1502033',name:'Procesos Contables II',credits:4,req:['1502021']},
{id:'1502152',name:'Ingl√©s III',credits:1,req:['1502151']},
{id:'1502873',name:'Herramientas Inform√°ticas',credits:2,req:[]},
{id:'1504103',name:'Matem√°ticas III',credits:3,req:['1504102']},
{id:'1506036',name:'Taller de Ret√≥rica',credits:3,req:['1506016']},
{id:'1506100',name:'Formaci√≥n Ciudadana',credits:0,req:[]}
]},
{level:'Nivel 4',courses:[
{id:'1502035',name:'Procesos Contables III',credits:4,req:['1502033']},
{id:'1502038',name:'N√∫cleos Probl√©micos I',credits:2,req:['1502031','1502033']},
{id:'HUM1',name:'Human√≠stica I',credits:3,req:['1506036']},
{id:'1502153',name:'Ingl√©s IV',credits:1,req:['1502152']},
{id:'1503608',name:'Microeconom√≠a',credits:4,req:['1504103']},
{id:'1504064',name:'M√©todos Estad√≠sticos',credits:4,req:['1504102']}
]},
{level:'Nivel 5',courses:[
{id:'1502043',name:'Estados Contables',credits:2,req:['1502031','1502035']},
{id:'1502050',name:'Costos I',credits:4,req:['1502031']},
{id:'1502055',name:'Modelaci√≥n Contable',credits:3,req:['1502024']},
{id:'HUM2',name:'Human√≠stica II',credits:3,req:['1506036']},
{id:'1502154',name:'Ingl√©s V',credits:1,req:['1502153']},
{id:'1503609',name:'Macroeconom√≠a',credits:4,req:['1503608']}
]},
{level:'Nivel 6',courses:[
{id:'1502045',name:'Contabilidad y Fen√≥menos Societarios',credits:3,req:['1502043']},
{id:'1502061',name:'Costos II',credits:3,req:['1502050']},
{id:'1502073',name:'Teor√≠a Contable',credits:3,req:['1502055']},
{id:'HUM3',name:'Human√≠stica III',credits:3,req:['1506036']},
{id:'1503070',name:'Pol√≠tica Monetaria y Fiscal',credits:3,req:['1503609']},
{id:'1502075',name:'Gesti√≥n y Contabilidad P√∫blica',credits:3,req:['1503609']},
{id:'1502155',name:'Ingl√©s VI',credits:1,req:['1502154']}
]},
{level:'Nivel 7',courses:[
{id:'1502048',name:'N√∫cleos Probl√©micos II',credits:2,req:['1502061']},
{id:'1502089',name:'Control',credits:4,req:['1502045']},
{id:'1502171',name:'Prospectiva y Presupuesto',credits:4,req:['1502061']},
{id:'1502178',name:'Toma de Decisiones I',credits:4,req:['1502061','1504064']},
{id:'1503074',name:'Econom√≠a Colombiana',credits:3,req:['1503070']}
]},
{level:'Nivel 8',courses:[
{id:'1502056',name:'Contabilidad y Administraci√≥n',credits:3,req:['1502178']},
{id:'1502079',name:'Toma de Decisiones II',credits:4,req:['1502171']},
{id:'1502088',name:'Tributarios I',credits:4,req:['1502045']},
{id:'1502091',name:'Procesos de Control',credits:4,req:['1502089']},
{id:'1502180',name:'An√°lisis Contable',credits:4,req:['1502171','1502043']}
]},
{level:'Nivel 9',courses:[
{id:'1502020',name:'Trabajo de Grado I',credits:2,req:['1502024']},
{id:'1502049',name:'N√∫cleos Probl√©micos III',credits:2,req:['1502079']},
{id:'1502190',name:'Tributarios II',credits:4,req:['1502088']},
{id:'1502192',name:'Gerencia Financiera',credits:3,req:['1502079']},
{id:'1502193',name:'Informes de Control',credits:3,req:['1502091']},
{id:'1502099',name:'Seminario Electivo',credits:3,req:[]}
]},
{level:'Nivel 10',courses:[
{id:'1502030',name:'Trabajo de Grado II',credits:3,req:['1502020']},
{id:'1502195',name:'Consultorio Contable',credits:3,req:[]}
]}
];

/* ===================== C√ÅLCULOS ===================== */
const TOTAL_CREDITS = data.flatMap(l=>l.courses)
                          .reduce((s,c)=>s+c.credits,0);

function approvedCredits(){
  return data.flatMap(l=>l.courses)
             .filter(c=>approved.has(c.id))
             .reduce((s,c)=>s+c.credits,0);
}

function levelStats(level){
  let total=0, approvedSum=0, plannedSum=0;
  level.courses.forEach(c=>{
    total+=c.credits;
    if(approved.has(c.id)) approvedSum+=c.credits;
    if(planning && plans[currentPlan]?.includes(c.id))
      plannedSum+=c.credits;
  });
  return {total, approvedSum, plannedSum};
}

/* ===================== PLANES ===================== */
function renderPlans(){
  const sel=document.getElementById('planSelect');
  sel.innerHTML='';
  Object.keys(plans).forEach(p=>{
    const o=document.createElement('option');
    o.value=p;o.textContent=p;
    if(p===currentPlan) o.selected=true;
    sel.appendChild(o);
  });
  sel.onchange=e=>{currentPlan=e.target.value;render();};
}
function newPlan(){
  const name=prompt('Nombre del semestre:');
  if(!name||plans[name])return;
  plans[name]=[];
  currentPlan=name;
  savePlans();render();
}
function deletePlan(){
  if(!currentPlan||!confirm('¬øEliminar plan?'))return;
  delete plans[currentPlan];
  currentPlan=Object.keys(plans)[0]||null;
  savePlans();render();
}
function savePlans(){
  localStorage.setItem('plans',JSON.stringify(plans));
}

/* ===================== RENDER ===================== */
function render(){
  renderPlans();
  const ac=approvedCredits();
  document.getElementById('creditText').textContent=
    `Cr√©ditos aprobados: ${ac} / ${TOTAL_CREDITS}`;
  document.getElementById('progressFill').style.width=
    `${ac/TOTAL_CREDITS*100}%`;

  document.getElementById('planCredits').textContent=
    planning && currentPlan ? `üìã Cr√©ditos del ${currentPlan}` : '';

  const grid=document.getElementById('grid');
  grid.innerHTML='';

  data.forEach(level=>{
    const {total,approvedSum,plannedSum}=levelStats(level);
    const col=document.createElement('div');
    col.className='column';
    col.innerHTML=`
      <h3>${level.level}</h3>
      <div class="level-info">
        Total del nivel: <strong>${total}</strong> cr√©ditos<br>
        ${planning
          ? `Planeados: ${plannedSum} / ${total}`
          : `Aprobados: ${approvedSum} / ${total}`}
      </div>
    `;
    level.courses.forEach(c=>{
      const d=document.createElement('div');
      d.className='course';
      d.textContent=`${c.name} (${c.credits})`;
      if(approved.has(c.id)) d.classList.add('approved');
      if(plans[currentPlan]?.includes(c.id)) d.classList.add('plan');
      d.onclick=()=>{
        if(planning){
          const arr=plans[currentPlan];
          arr.includes(c.id)
            ? arr.splice(arr.indexOf(c.id),1)
            : arr.push(c.id);
          savePlans();render();return;
        }
        approved.has(c.id)
          ? approved.delete(c.id)
          : approved.add(c.id);
        localStorage.setItem(
          'approvedCourses',
          JSON.stringify([...approved])
        );
        render();
      };
      col.appendChild(d);
    });
    grid.appendChild(col);
  });
}

function togglePlan(){planning=!planning;render();}
function toggleDark(){document.body.classList.toggle('dark');}

/* ===================== INIT ===================== */
if(!Object.keys(plans).length){
  plans['Semestre 1']=[];
  currentPlan='Semestre 1';
}
render();
</script>

</body>
</html>
