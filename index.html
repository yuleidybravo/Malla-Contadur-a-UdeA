<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Malla Curricular Contaduría</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 5px;
    }
    .credits {
      text-align: center;
      margin-bottom: 25px;
      font-weight: 600;
      color: #4a6fa5;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
    }
    .column {
      background: #ffffff;
      border-radius: 12px;
      padding: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    .column h2 {
      text-align: center;
      font-size: 1.05em;
      margin-bottom: 10px;
      color: #4a6fa5;
    }
    .course {
      background: #e9edf3;
      margin-bottom: 8px;
      padding: 8px 10px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.88em;
      position: relative;
      transition: all 0.2s ease;
    }
    .course small {
      display: block;
      font-size: 0.75em;
      opacity: 0.7;
    }
    .course:hover {
      transform: scale(1.02);
    }
    .approved {
      background: #cfe8cf;
      text-decoration: line-through;
    }
    .locked {
      background: #f2dede;
      cursor: not-allowed;
      color: #888;
    }
    .locked:hover::after {
      content: attr(data-tooltip);
      position: absolute;
      left: 50%;
      bottom: 110%;
      transform: translateX(-50%);
      background: #333;
      color: #fff;
      padding: 6px 8px;
      border-radius: 6px;
      font-size: 0.75em;
      white-space: pre-line;
      z-index: 10;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular – Contaduría</h1>
  <div id="credits" class="credits"></div>
  <div id="grid" class="grid"></div>

  <script>
    const data = [
      { level: 'Nivel 1', courses: [
        { id:'1502010', name:'Cultura Contable', credits:3, req:[] },
        { id:'1502014', name:'Semillero de Investigación I', credits:1, req:[] },
        { id:'1502015', name:'Fundamentos Interdisciplinarios de la Contabilidad', credits:4, req:[] },
        { id:'1502016', name:'Interdisciplinariedad del Ente Económico', credits:4, req:[] },
        { id:'1502150', name:'Inglés I', credits:1, req:[] },
        { id:'1504101', name:'Matemáticas I', credits:4, req:[] }
      ]},
      { level: 'Nivel 2', courses: [
        { id:'1502021', name:'Estructura Contable', credits:3, req:['1502015'] },
        { id:'1502024', name:'Metodología de la Investigación Contable', credits:5, req:[] },
        { id:'1502026', name:'Semillero de Investigación II', credits:1, req:['1502014'] },
        { id:'1502151', name:'Inglés II', credits:1, req:['1502150'] },
        { id:'1504102', name:'Matemáticas II', credits:3, req:['1504101'] },
        { id:'1506016', name:'Taller de Lectura y Escritura', credits:3, req:[] }
      ]},
      { level: 'Nivel 3', courses: [
        { id:'1502031', name:'Procesos Contables I', credits:4, req:['1502021'] },
        { id:'1502033', name:'Procesos Contables II', credits:4, req:['1502021'] },
        { id:'1502152', name:'Inglés III', credits:1, req:['1502151'] },
        { id:'1502873', name:'Herramientas Informáticas', credits:2, req:[] },
        { id:'1504103', name:'Matemáticas III', credits:3, req:['1504102'] },
        { id:'1506036', name:'Taller de Retórica y Argumentación', credits:3, req:['1506016'] },
        { id:'1506100', name:'Formación Ciudadana y Constitucional', credits:0, req:[] }
      ]},
      { level: 'Nivel 4', courses: [
        { id:'1502035', name:'Procesos Contables III', credits:4, req:['1502033'] },
        { id:'1502038', name:'Núcleos Problémicos I', credits:2, req:['1502873','1502031','1502033'] },
        { id:'1502153', name:'Inglés IV', credits:1, req:['1502152'] },
        { id:'1503608', name:'Microeconomía', credits:4, req:['1504103'] },
        { id:'1504064', name:'Métodos Estadísticos', credits:4, req:['1504102'] }
      ]},
      { level: 'Nivel 5', courses: [
        { id:'1502043', name:'Estados Contables', credits:2, req:['1502031','1502035'] },
        { id:'1502050', name:'Costos I', credits:4, req:['1502031'] },
        { id:'1502055', name:'Modelación Contable', credits:3, req:['1502024'] },
        { id:'1502154', name:'Inglés V', credits:1, req:['1502153'] },
        { id:'1503609', name:'Macroeconomía', credits:4, req:['1503608'] }
      ]},
      { level: 'Nivel 6', courses: [
        { id:'1502045', name:'Contabilidad y Fenómenos Societarios', credits:3, req:['1502043'] },
        { id:'1502061', name:'Costos II', credits:3, req:['1502050'] },
        { id:'1502073', name:'Teoría Contable', credits:3, req:['1502055','1502010'] },
        { id:'1502075', name:'Gestión y Contabilidad Pública', credits:3, req:['1503609','1502043'] },
        { id:'1502155', name:'Inglés VI', credits:1, req:['1502154'] },
        { id:'1503070', name:'Política Monetaria y Fiscal', credits:3, req:['1503609'] }
      ]},
      { level: 'Nivel 7', courses: [
        { id:'1502048', name:'Núcleos Problémicos II', credits:2, req:['1502061','1502045'] },
        { id:'1502089', name:'Control', credits:4, req:['1502045'] },
        { id:'1502171', name:'Prospectiva y Presupuesto', credits:4, req:['1502061'] },
        { id:'1502178', name:'Toma de Decisiones I', credits:4, req:['1502061','1504064'] },
        { id:'1503074', name:'Economía Colombiana', credits:3, req:['1503070'] }
      ]},
      { level: 'Nivel 8', courses: [
        { id:'1502056', name:'Contabilidad y Administración', credits:3, req:['1502016','1502178'] },
        { id:'1502079', name:'Toma de Decisiones II', credits:4, req:['1502171'] },
        { id:'1502088', name:'Obligaciones y Procedimientos Tributarios I', credits:4, req:['1503074','1502045'] },
        { id:'1502091', name:'Procesos de Control', credits:4, req:['1502089'] },
        { id:'1502180', name:'Análisis Contable', credits:4, req:['1502043','1502171'] }
      ]},
      { level: 'Nivel 9', courses: [
        { id:'1502020', name:'Trabajo de Grado I', credits:2, req:['1502024'] },
        { id:'1502049', name:'Núcleos Problémicos III', credits:2, req:['1502079'] },
        { id:'1502190', name:'Obligaciones y Procedimientos Tributarios II', credits:4, req:['1502088'] },
        { id:'1502192', name:'Gerencia Financiera', credits:3, req:['1502180','1502079'] },
        { id:'1502193', name:'Informes de Control', credits:3, req:['1502091'] }
      ]},
      { level: 'Nivel 10', courses: [
        { id:'1502030', name:'Trabajo de Grado II', credits:3, req:['1502020'] },
        { id:'1502195', name:'Consultorio Contable', credits:3, req:[] }
      ]}
    ];

    const approved = new Set(JSON.parse(localStorage.getItem('approvedCourses') || '[]'));
    const grid = document.getElementById('grid');
    const creditsDiv = document.getElementById('credits');

    function canUnlock(reqs) {
      return reqs.every(r => approved.has(r));
    }

    function totalCredits() {
      let sum = 0;
      data.forEach(l => l.courses.forEach(c => {
        if (approved.has(c.id)) sum += c.credits;
      }));
      return sum;
    }

    function render() {
      grid.innerHTML = '';
      creditsDiv.textContent = `Créditos aprobados: ${totalCredits()}`;

      data.forEach(col => {
        const div = document.createElement('div');
        div.className = 'column';
        div.innerHTML = `<h2>${col.level}</h2>`;

        col.courses.forEach(c => {
          const course = document.createElement('div');
          course.className = 'course';
          course.innerHTML = `${c.name}<small>${c.credits} créditos</small>`;

          const unlocked = canUnlock(c.req);
          if (!unlocked) {
            course.classList.add('locked');
            course.dataset.tooltip = 'Falta aprobar:\n' + c.req.filter(r => !approved.has(r)).join(', ');
          } else if (approved.has(c.id)) {
            course.classList.add('approved');
          }

          course.onclick = () => {
            if (!unlocked) return;
            approved.has(c.id) ? approved.delete(c.id) : approved.add(c.id);
            localStorage.setItem('approvedCourses', JSON.stringify([...approved]));
            render();
          };

          div.appendChild(course);
        });
        grid.appendChild(div);
      });
    }

    render();
  </script>
</body>
</html>
