<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Malla Curricular â€“ ContadurÃ­a PÃºblica</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#eef4fb;
  --card:#ffffff;
  --text:#1f2a44;
  --primary:#2f5fa3;
  --light:#e9f1fb;
  --approved:#b7d3f6;
  --locked:#edf2f9;
}
body{
  margin:0;
  padding:20px;
  font-family:'Poppins',sans-serif;
  background:var(--bg);
  color:var(--text);
}
h1{text-align:center;color:var(--primary)}

.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
  margin-bottom:15px;
}
button,select{
  padding:6px 10px;
  border-radius:8px;
  border:none;
}
button{
  background:var(--primary);
  color:#fff;
  cursor:pointer;
}

.grid{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:16px;
}

.column{
  background:var(--card);
  border-radius:16px;
  padding:12px;
}

.column h3{
  text-align:center;
  color:var(--primary);
}

.level-info{
  text-align:center;
  font-size:.75em;
  margin-bottom:10px;
  line-height:1.4;
}

.course{
  background:var(--light);
  padding:8px;
  border-radius:10px;
  margin-bottom:8px;
  cursor:pointer;
  font-size:.85em;
}

.course:hover{transform:scale(1.03)}

.approved{
  background:var(--approved);
  text-decoration:line-through;
}

.locked{
  background:var(--locked);
  opacity:.5;
  cursor:not-allowed;
}

.plan{
  outline:2px dashed var(--primary);
}
</style>
</head>

<body>

<h1>Malla Curricular â€“ ContadurÃ­a PÃºblica</h1>

<div class="top">
  <div id="creditText"></div>
  <div>
    <select id="planSelect"></select>
    <button onclick="newPlan()">âž• Plan</button>
    <button onclick="togglePlan()">ðŸ“‹ Planear</button>
  </div>
</div>

<div id="grid" class="grid"></div>

<script>
/* ================= ESTADO ================= */
const approved = new Set(JSON.parse(localStorage.getItem('approvedCourses') || '[]'));
let plans = JSON.parse(localStorage.getItem('plans') || '{}');
let currentPlan = null;
let planning = false;

/* ================= DATA COMPLETA (NIVELES 1â€“10) ================= */
const data = [
{level:'Nivel 1',courses:[
{id:'N1A',name:'Cultura Contable',credits:3,req:[]},
{id:'N1B',name:'MatemÃ¡ticas I',credits:4,req:[]},
{id:'N1C',name:'InglÃ©s I',credits:1,req:[]}
]},
{level:'Nivel 2',courses:[
{id:'N2A',name:'Estructura Contable',credits:3,req:['N1A']},
{id:'N2B',name:'MatemÃ¡ticas II',credits:3,req:['N1B']},
{id:'N2C',name:'InglÃ©s II',credits:1,req:['N1C']}
]},
{level:'Nivel 3',courses:[
{id:'N3A',name:'Procesos Contables I',credits:4,req:['N2A']},
{id:'N3B',name:'Herramientas InformÃ¡ticas',credits:2,req:[]},
{id:'N3C',name:'FormaciÃ³n Ciudadana',credits:0,req:[]}
]},
{level:'Nivel 4',courses:[
{id:'N4A',name:'Procesos Contables II',credits:4,req:['N3A']},
{id:'N4B',name:'HumanÃ­stica I',credits:3,req:['N3A']}
]},
{level:'Nivel 5',courses:[
{id:'N5A',name:'Estados Contables',credits:2,req:['N4A']},
{id:'N5B',name:'HumanÃ­stica II',credits:3,req:['N3A']},
{id:'N5C',name:'MacroeconomÃ­a',credits:4,req:['N2B']}
]},
{level:'Nivel 6',courses:[
{id:'N6A',name:'Costos I',credits:4,req:['N3A']},
{id:'N6B',name:'HumanÃ­stica III',credits:3,req:['N3A']},
{id:'N6C',name:'PolÃ­tica Monetaria y Fiscal',credits:3,req:['N5C']}
]},
{level:'Nivel 7',courses:[
{id:'N7A',name:'EconomÃ­a Colombiana',credits:3,req:['N6C']},
{id:'N7B',name:'Prospectiva y Presupuesto',credits:4,req:['N6A']},
{id:'N7C',name:'Toma de Decisiones I',credits:4,req:['N6A']}
]},
{level:'Nivel 8',courses:[
{id:'N8A',name:'AnÃ¡lisis Contable',credits:4,req:['N5A','N7B']},
{id:'N8B',name:'Toma de Decisiones II',credits:4,req:['N7C']},
{id:'N8C',name:'Procesos de Control',credits:4,req:['N7A']}
]},
{level:'Nivel 9',courses:[
{id:'N9A',name:'Informes de Control',credits:3,req:['N8C']},
{id:'N9B',name:'NÃºcleos ProblÃ©micos III',credits:2,req:['N8B']},
{id:'N9C',name:'Trabajo de Grado I',credits:2,req:[]}
]},
{level:'Nivel 10',courses:[
{id:'N10A',name:'Trabajo de Grado II',credits:3,req:['N9C']},
{id:'N10B',name:'Consultorio Contable',credits:3,req:[]}
]}
];

/* ================= LÃ“GICA ACADÃ‰MICA ================= */
function canUnlock(course){
  return course.req.every(r => approved.has(r));
}

function removeDependents(id){
  data.forEach(level=>{
    level.courses.forEach(c=>{
      if(c.req.includes(id) && approved.has(c.id)){
        approved.delete(c.id);
        removeDependents(c.id);
      }
    });
  });
}

function totalApprovedCredits(){
  let sum=0;
  data.forEach(l=>{
    l.courses.forEach(c=>{
      if(approved.has(c.id)) sum+=c.credits;
    });
  });
  return sum;
}

function levelStats(level){
  let total=0, approvedSum=0, plannedSum=0;
  level.courses.forEach(c=>{
    total+=c.credits;
    if(approved.has(c.id)) approvedSum+=c.credits;
    if(planning && plans[currentPlan]?.includes(c.id))
      plannedSum+=c.credits;
  });
  return {total, approvedSum, plannedSum};
}

/* ================= RENDER ================= */
function render(){
  document.getElementById('creditText').textContent =
    `CrÃ©ditos aprobados: ${totalApprovedCredits()}`;

  const grid=document.getElementById('grid');
  grid.innerHTML='';

  data.forEach(level=>{
    const {total, approvedSum, plannedSum}=levelStats(level);
    const col=document.createElement('div');
    col.className='column';
    col.innerHTML=`
      <h3>${level.level}</h3>
      <div class="level-info">
        Total del nivel: ${total} crÃ©ditos<br>
        ${planning
          ? `Planeados: ${plannedSum} / ${total}`
          : `Aprobados: ${approvedSum} / ${total}`}
      </div>
    `;

    level.courses.forEach(c=>{
      const d=document.createElement('div');
      d.className='course';
      d.textContent=`${c.name} (${c.credits})`;

      const unlocked=canUnlock(c);

      if(!planning && !unlocked && !approved.has(c.id)){
        d.classList.add('locked');
        d.title='Faltan prerrequisitos';
      }

      if(approved.has(c.id)) d.classList.add('approved');
      if(planning && plans[currentPlan]?.includes(c.id)) d.classList.add('plan');

      d.onclick=()=>{
        if(planning){
          const arr=plans[currentPlan];
          arr.includes(c.id)
            ? arr.splice(arr.indexOf(c.id),1)
            : arr.push(c.id);
          savePlans();
          render();
          return;
        }

        if(!unlocked && !approved.has(c.id)) return;

        if(approved.has(c.id)){
          approved.delete(c.id);
          removeDependents(c.id);
        }else{
          approved.add(c.id);
        }

        localStorage.setItem(
          'approvedCourses',
          JSON.stringify([...approved])
        );
        render();
      };

      col.appendChild(d);
    });

    grid.appendChild(col);
  });
}

/* ================= PLANES ================= */
function renderPlans(){
  const sel=document.getElementById('planSelect');
  sel.innerHTML='';
  Object.keys(plans).forEach(p=>{
    const o=document.createElement('option');
    o.value=p;o.textContent=p;
    if(p===currentPlan) o.selected=true;
    sel.appendChild(o);
  });
  sel.onchange=e=>{
    currentPlan=e.target.value;
    render();
  };
}

function newPlan(){
  const name=prompt('Nombre del semestre:');
  if(!name||plans[name]) return;
  plans[name]=[];
  currentPlan=name;
  savePlans();
  render();
}

function savePlans(){
  localStorage.setItem('plans',JSON.stringify(plans));
}

function togglePlan(){
  planning=!planning;
  render();
}

/* ================= INIT ================= */
if(!Object.keys(plans).length){
  plans['Semestre 1']=[];
  currentPlan='Semestre 1';
}
renderPlans();
render();
</script>

</body>
</html>
